<html>
  <head>
    <meta charset='utf-8'>
    <title>/home/xavier/devel/ruby/yabu/lib/yabu/options.rb</title>
    <link rel="stylesheet" href="css/coco.css" type="text/css" />
  </head>
  <body>
    <p class="menu">
      <a href="index.html">Index</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="https://github.com/lkdjiin/coco/wiki">Wiki</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="https://github.com/lkdjiin/coco">Source</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="http://lkdjiin.github.com/coco/">Web site</a>
    </p>
    <h2>/home/xavier/devel/ruby/yabu/lib/yabu/options.rb</h2>
    <p class="date">2011-03-01 17:38:30 +0100</p>
    
    <table class="source">
      
                    <tr class="never">
      
      <td><pre>1 </pre></td><td><pre></pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>2 </pre></td><td><pre>require 'optparse'</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>3 </pre></td><td><pre></pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>4 </pre></td><td><pre># I parse the command line.</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>5 </pre></td><td><pre># Currently, there's only options that display messages and exit. So you can instanciate me before</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>6 </pre></td><td><pre># dealing with class Backup and the like.</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>7 </pre></td><td><pre># @example</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>8 </pre></td><td><pre>#		opt = Options.new # Exit if there are an option</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>9 </pre></td><td><pre>#		bk = Backup.new # But do this if there are not.</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>10 </pre></td><td><pre>class Options</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>11 </pre></td><td><pre>	attr_reader :options</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>12 </pre></td><td><pre>	# Here is a list of command line options :</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>13 </pre></td><td><pre>	# * --force</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>14 </pre></td><td><pre>	# * --version</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>15 </pre></td><td><pre>	# * --license</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>16 </pre></td><td><pre>	# * --help</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>17 </pre></td><td><pre>	# * --test</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>18 </pre></td><td><pre>	# @todo refactoring</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>19 </pre></td><td><pre>	def initialize</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>20 </pre></td><td><pre>		@options = {}</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>21 </pre></td><td><pre>		optparse = OptionParser.new do|opts|</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>22 </pre></td><td><pre>		 	opts.banner = "Usage: yabu [options] [command]\n\n"</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>23 </pre></td><td><pre>			opts.banner += "Where command is\n"</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>24 </pre></td><td><pre>			opts.banner += "  backup : start the backup (default command)\n"</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>25 </pre></td><td><pre>			opts.banner += "  recover: restore missing files from the most recent backup\n"</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>26 </pre></td><td><pre>			opts.banner += "  help command_name: display help on command_name\n\n"</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>27 </pre></td><td><pre>			opts.banner += "And options are\n"</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>28 </pre></td><td><pre></pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>29 </pre></td><td><pre>   		@options[:version] = false</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>30 </pre></td><td><pre>   		opts.on( '-v', '--version', 'Print version number and exit' ) do</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>31 </pre></td><td><pre>     		@options[:version] = true</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>32 </pre></td><td><pre>   		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>33 </pre></td><td><pre>   		</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>34 </pre></td><td><pre>   		@options[:license] = false</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>35 </pre></td><td><pre>   		opts.on( '-l', '--license', 'Print program\'s license and exit' ) do</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>36 </pre></td><td><pre>     		@options[:license] = true</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>37 </pre></td><td><pre>   		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>38 </pre></td><td><pre>   		</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>39 </pre></td><td><pre>   		@options[:test] = false</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>40 </pre></td><td><pre>   		opts.on( '-t', '--test', 'Log all' ) do</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>41 </pre></td><td><pre>     		@options[:test] = true</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>42 </pre></td><td><pre>   		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>43 </pre></td><td><pre>			</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>44 </pre></td><td><pre>			@options[:force] = false</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>45 </pre></td><td><pre>   		opts.on( '-f', '--force', 'Force to recover ALL files' ) do</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>46 </pre></td><td><pre>     		@options[:force] = true</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>47 </pre></td><td><pre>   		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>48 </pre></td><td><pre>   		</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>49 </pre></td><td><pre>   		opts.on( '-h', '--help', 'Display this screen' ) do</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>50 </pre></td><td><pre>     		puts opts</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>51 </pre></td><td><pre>     		exit</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>52 </pre></td><td><pre>   		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>53 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>54 </pre></td><td><pre>		begin</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>55 </pre></td><td><pre>			optparse.parse!</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>56 </pre></td><td><pre>		rescue OptionParser::InvalidOption =&gt; e</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>57 </pre></td><td><pre>			puts e.to_s</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>58 </pre></td><td><pre>			exit 1</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>59 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>60 </pre></td><td><pre>		print_version if @options[:version]</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>61 </pre></td><td><pre>		print_license if @options[:license]</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>62 </pre></td><td><pre>	end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>63 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>64 </pre></td><td><pre>	def [](key)</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>65 </pre></td><td><pre>		@options[key]</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>66 </pre></td><td><pre>	end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>67 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>68 </pre></td><td><pre>private</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>69 </pre></td><td><pre></pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>70 </pre></td><td><pre>	def print_version</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>71 </pre></td><td><pre>		puts Yabu.version</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>72 </pre></td><td><pre>		exit</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>73 </pre></td><td><pre>	end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>74 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>75 </pre></td><td><pre>	def print_license</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>76 </pre></td><td><pre>		Yabu::Message.print_license</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>77 </pre></td><td><pre>		exit</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>78 </pre></td><td><pre>	end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>79 </pre></td><td><pre>end</pre></td>
        </tr>
            
    </table>
  </body>
</html>
