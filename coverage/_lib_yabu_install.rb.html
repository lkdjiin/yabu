<html>
  <head>
    <meta charset='utf-8'>
    <title>/home/xavier/devel/ruby/yabu/lib/yabu/install.rb</title>
    <link rel="stylesheet" href="css/coco.css" type="text/css" />
  </head>
  <body>
    <p class="menu">
      <a href="index.html">Index</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="https://github.com/lkdjiin/coco/wiki">Wiki</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="https://github.com/lkdjiin/coco">Source</a> <img src="img/coconut16.png" width="16" height="16" />
      <a href="http://lkdjiin.github.com/coco/">Web site</a>
    </p>
    <h2>/home/xavier/devel/ruby/yabu/lib/yabu/install.rb</h2>
    <p class="date">2011-03-01 17:38:30 +0100</p>
    
    <table class="source">
      
                    <tr class="hit" %>      
      <td><pre>1 </pre></td><td><pre>require 'fileutils'</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>2 </pre></td><td><pre></pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>3 </pre></td><td><pre>module Yabu</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>4 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>5 </pre></td><td><pre>	# Install config files and version file in user's home</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>6 </pre></td><td><pre>	# @since 0.6</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>7 </pre></td><td><pre>	module Install</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>8 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>9 </pre></td><td><pre>		# Do we need to install some config files in the user's home folder ? </pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>10 </pre></td><td><pre>		def Install.needed?</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>11 </pre></td><td><pre>			not File.exists?(File.join(ENV['HOME'], '.config/yabu'))</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>12 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>13 </pre></td><td><pre>		</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>14 </pre></td><td><pre>		# @return true if version installed is different of this version of Yabu.</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>15 </pre></td><td><pre>		# @since 0.7</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>16 </pre></td><td><pre>		# @note I don't take any account of higher or lower version, just difference.</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>17 </pre></td><td><pre>		def Install.upgrade?</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>18 </pre></td><td><pre>			my_version = Yabu.version</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>19 </pre></td><td><pre>			installed_version = File.read(File.join(ENV['HOME'], '.config/yabu/VERSION')).strip</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>20 </pre></td><td><pre>			my_version != installed_version</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>21 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>22 </pre></td><td><pre>		</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>23 </pre></td><td><pre>		# Copy file version in yabu hidden config folder.</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>24 </pre></td><td><pre>		# @since 0.7</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>25 </pre></td><td><pre>		def Install.upgrade</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>26 </pre></td><td><pre>			FileUtils.cp(File.join($YABU_PATH, 'VERSION'), File.join(ENV['HOME'], '.config/yabu'))</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>27 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>28 </pre></td><td><pre>		</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>29 </pre></td><td><pre>		# Install config files in user's home folder</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>30 </pre></td><td><pre>		# List of copied files:</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>31 </pre></td><td><pre>		# * VERSION</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>32 </pre></td><td><pre>		# * configuration/directories.conf</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>33 </pre></td><td><pre>		# * configuration/yabu.conf</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>34 </pre></td><td><pre>		def Install.run</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>35 </pre></td><td><pre>			conf = File.join(ENV['HOME'], '.config/yabu/configuration')</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>36 </pre></td><td><pre>			yab = File.join(ENV['HOME'], '.config/yabu')</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>37 </pre></td><td><pre>			FileUtils.makedirs(conf)</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>38 </pre></td><td><pre>			FileUtils.cp("#{$YABU_PATH}/VERSION", yab)</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>39 </pre></td><td><pre>			FileUtils.cp("#{$YABU_PATH}/configuration/directories.conf", conf)</pre></td>
        </tr>
                    <tr class="miss">
      
      <td><pre>40 </pre></td><td><pre>			FileUtils.cp("#{$YABU_PATH}/configuration/yabu.conf", conf)</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>41 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>42 </pre></td><td><pre>		</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>43 </pre></td><td><pre>		def Install.message</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>44 </pre></td><td><pre>			puts "This is your first installation of yabu."</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>45 </pre></td><td><pre>			puts "Some files have been copied in #{ENV['HOME']}/.config/yabu/"</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>46 </pre></td><td><pre>			puts "Please, look at the documentation to modify those files, in order to suit your needs."</pre></td>
        </tr>
                    <tr class="hit" %>      
      <td><pre>47 </pre></td><td><pre>			puts "Restart yabu when you are ready."</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>48 </pre></td><td><pre>		end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>49 </pre></td><td><pre>	</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>50 </pre></td><td><pre>	end</pre></td>
        </tr>
                    <tr class="never">
      
      <td><pre>51 </pre></td><td><pre>end</pre></td>
        </tr>
            
    </table>
  </body>
</html>
